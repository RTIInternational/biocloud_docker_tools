{
    "name": "entrypoint_bfile",
    "inputs": {
        "output_dir": {
            "type": "str",
            "default": "",
            "required": true
        },
        "bed": {
            "type": "file",
            "default": "",
            "required": true
        },
        "bim": {
            "type": "file",
            "default": "",
            "required": true
        },
        "fam": {
            "type": "file",
            "default": "",
            "required": true
        },
        "variant_list": {
            "type": "file",
            "default": "",
            "required": true
        },
        "hladq_variants_file": {
            "type": "file",
            "default": "",
            "required": true
        },
        "non_hladq_variants_file": {
            "type": "file",
            "default": "",
            "required": true
        },
        "t1dgrs2_yml": {
            "type": "file",
            "default": "/pipeline/config/t1dgrs2_settings.yml",
            "required": false
        },
        "missing_hla_threshold": {
            "type": "int",
            "default": 1,
            "required": false
        },
        "missing_non_hla_threshold": {
            "type": "int",
            "default": 3,
            "required": false
        }
    },
    "outputs": {
        "log": {
            "type": "file",
            "value": "<inputs.output_dir>entrypoint_bfile.log"
        }
    },
    "entry_point": "extract_bfile_variants",
    "entry_point_inputs": {
        "output_dir": "<inputs.output_dir>extract_bfile_variants",
        "bed": "<inputs.bed>",
        "bim": "<inputs.bim>",
        "fam": "<inputs.fam>",
        "variant_list": "<inputs.variant_list>",
        "out_prefix": "<inputs.output_dir>extract_bfile_variants/samples"
    },
    "pipeline": {
        "extract_bfile_variants": {
            "task": "extract_bfile_variants",
            "check_output": {
                "returncode_0": {
                    "step": "analyze_missingness",
                    "inputs": {
                        "output_dir": "<inputs.output_dir>analyze_missingness",
                        "vcf": "<steps.extract_bfile_variants.outputs.vcf>",
                        "hladq_variants_file": "<inputs.hladq_variants_file>",
                        "non_hladq_variants_file": "<inputs.non_hladq_variants_file>",
                        "out_prefix": "<inputs.output_dir>analyze_missingness/samples"
                    }
                },
                "returncode_1": { 
                    "step": "error"
                }
            }
        },
        "analyze_missingness": {
            "task": "analyze_missingness",
            "check_output": {
                "returncode_0": {
                    "step": "convert_vcf_to_bfile",
                    "inputs": {
                        "output_dir": "<inputs.output_dir>convert_vcf_to_bfile",
                        "vcf": "<steps.extract_bfile_variants.outputs.vcf>",
                        "out_prefix": "<inputs.output_dir>convert_vcf_to_bfile/samples"
                    }
                },
                "returncode_1": { 
                    "step": "error"
                }
            }
        },
        "convert_vcf_to_bfile": {
            "task": "convert_vcf_to_bfile",
            "check_output": {
                "returncode_0": {
                    "step": "calculate_t1dgrs2",
                    "inputs": {
                        "output_dir": "<inputs.output_dir>calculate_t1dgrs2",
                        "bfile": "<steps.convert_vcf_to_bfile.outputs.bfile>",
                        "yml": "<inputs.t1dgrs2_yml>",
                        "out_prefix": "<inputs.output_dir>calculate_t1dgrs2/t1dgrs2"
                    }
                },
                "returncode_1": { 
                    "step": "error"
                }
            }
        },
        "calculate_t1dgrs2": {
            "task": "calculate_t1dgrs2",
            "check_output": {
                "returncode_0": {
                    "step": "generate_report",
                    "inputs": {
                        "output_dir": "<inputs.output_dir>generate_report",
                        "t1dgrs2_results_file": "<steps.calculate_t1dgrs2.outputs.results>",
                        "missingness_summary_file": "<steps.analyze_missingness.outputs.missing_summary>",
                        "missing_hla_threshold": "<inputs.missing_hla_threshold>",
                        "missing_non_hla_threshold": "<inputs.missing_non_hla_threshold>"
                    }
                },
                "returncode_1": {
                    "step": "error"
                }
            }
        },
        "generate_report": {
            "task": "generate_report",
            "check_output": {
                "returncode_0": {
                    "step": "exit"
                },
                "returncode_1": { 
                    "step": "error"
                }
            }
        }
    }
}
